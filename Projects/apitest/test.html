<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cybersecurity Tools</title>
    <style>
      body {
        font-family: Arial, sans-serif;

        < !doctype html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>Cybersecurity Tools</title><style>body {
          font-family: Arial, sans-serif;
          text-align: center;
          padding: 20px;
        }

        input,
        button {
          margin: 10px;
          padding: 10px;
        }

        #result {
          margin-top: 20px;
        }
    </style>
  </head>

  <body>
    <h2>Cybersecurity API Demo</h2>

    <h3>Check If Email is Breached</h3>
    <input type="email" id="email" placeholder="Enter email" />
    <button onclick="checkBreach()">Check Breach</button>
    <p id="breachResult"></p>

    <h3>Check IP & VPN Info</h3>
    <button onclick="checkIP()">Get My IP Info</button>
    <p id="ipResult"></p>

    <h3>Check Phishing URL</h3>
    <input type="text" id="url" placeholder="Enter URL" />
    <button onclick="checkPhishing()">Check Phishing</button>
    <p id="phishResult"></p>

    <h3>Google Safe Browsing URL Check</h3>
    <input type="text" id="safeBrowsingUrl" placeholder="Enter URL" />
    <button onclick="checkSafeBrowsing()">Check URL</button>
    <p id="safeBrowsingResult"></p>

    <h3>VirusTotal URL Scan</h3>
    <input type="text" id="virusTotalUrl" placeholder="Enter URL" />
    <button onclick="checkVirusTotal()">Scan URL</button>
    <p id="virusTotalResult"></p>

    <script>
      async function checkBreach() {
        const email = document.getElementById("email").value;
        if (!email) {
          alert("Enter an email");
          return;
        }

        const url = `https://haveibeenpwned.com/api/v3/breachedaccount/${email}`;
        try {
          const response = await fetch(url, {
            headers: { "hibp-api-key": "YOUR_API_KEY" },
          });
          const data = await response.json();
          document.getElementById("breachResult").innerText = data.length
            ? `Breached: ${JSON.stringify(data)}`
            : "No Breach Found";
        } catch (error) {
          document.getElementById("breachResult").innerText =
            "Error checking breach";
        }
      }

      async function checkIP() {
        try {
          const response = await fetch("https://ipinfo.io/json");
          const data = await response.json();
          document.getElementById("ipResult").innerText =
            `IP: ${data.ip}, Location: ${data.city}, ${data.country}, VPN: ${data.bogon ? "Yes" : "No"}`;
        } catch (error) {
          document.getElementById("ipResult").innerText = "Error fetching IP";
        }
      }

      async function checkPhishing() {
        const url = document.getElementById("url").value;
        if (!url) {
          alert("Enter a URL");
          return;
        }

        try {
          const response = await fetch(
            "https://checkphish.bolster.ai/api/v1/check/url",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                "x-api-key": "YOUR_API_KEY",
              },
              body: JSON.stringify({ url }),
            },
          );
          const data = await response.json();
          document.getElementById("phishResult").innerText = data.disposition
            ? `Phishing: ${data.disposition}`
            : "Safe URL";
        } catch (error) {
          document.getElementById("phishResult").innerText =
            "Error checking phishing";
        }
      }

      async function checkSafeBrowsing() {
        const url = document.getElementById("safeBrowsingUrl").value;
        if (!url) {
          alert("Enter a URL");
          return;
        }

        const apiKey = "YOURAPIKEY";
        const requestBody = {
          client: { clientId: "yourcompany", clientVersion: "1.0" },
          threatInfo: {
            threatTypes: ["MALWARE", "SOCIAL_ENGINEERING"],
            platformTypes: ["ANY_PLATFORM"],
            threatEntryTypes: ["URL"],
            threatEntries: [{ url }],
          },
        };

        try {
          const response = await fetch(
            `https://safebrowsing.googleapis.com/v4/threatMatches:find?key=${apiKey}`,
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(requestBody),
            },
          );
          const data = await response.json();
          document.getElementById("safeBrowsingResult").innerText = data.matches
            ? "Unsafe URL"
            : "Safe URL";
        } catch (error) {
          document.getElementById("safeBrowsingResult").innerText =
            "Error checking URL";
        }
      }

      async function checkVirusTotal() {
        const urlInput = document.getElementById("virusTotalUrl").value;
        if (!urlInput) {
          alert("Enter a URL");
          return;
        }

        const options = {
          method: "POST",
          headers: {
            accept: "application/json",
            "x-apikey":
              "YOURAPIKEY", // Replace with your API key
            "content-type": "application/x-www-form-urlencoded",
          },
          body: new URLSearchParams({ url: urlInput }),
        };

        try {
          // Step 1: Submit the URL for analysis
          const response = await fetch(
            "https://www.virustotal.com/api/v3/urls",
            options,
          );
          const data = await response.json();

          if (!data.data || !data.data.id) {
            document.getElementById("virusTotalResult").innerText =
              "Error submitting URL for scanning.";
            return;
          }

          const analysisId = data.data.id;
          await new Promise((resolve) => setTimeout(resolve, 5000)); // Wait 5 seconds for analysis

          // Step 2: Fetch the scan results
          const resultResponse = await fetch(
            `https://www.virustotal.com/api/v3/analyses/${analysisId}`,
            {
              method: "GET",
              headers: {
                accept: "application/json",
                "x-apikey":
                  "c3d13c31e6dc49974bbe63f0e5581aa06fd01e59f24702efe0e2f971dd4cfcb0",
              },
            },
          );

          const resultData = await resultResponse.json();

          if (
            resultData.data &&
            resultData.data.attributes &&
            resultData.data.attributes.stats
          ) {
            const stats = resultData.data.attributes.stats;
            const maliciousCount = stats.malicious || 0;

            document.getElementById("virusTotalResult").innerText =
              maliciousCount > 0
                ? `⚠️ Warning! ${maliciousCount} sources flagged this URL as malicious.`
                : "✅ Safe URL. No malicious activity detected.";
          } else {
            document.getElementById("virusTotalResult").innerText =
              "Error retrieving scan results.";
          }
        } catch (error) {
          document.getElementById("virusTotalResult").innerText =
            "Error scanning URL.";
          console.error(error);
        }
      }
    </script>
  </body>
</html>
